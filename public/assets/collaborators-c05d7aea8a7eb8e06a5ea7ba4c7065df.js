$(document).ready(function(){function e(e){$(e).tokenInput(gon.collaborator_search,{method:"POST",minChars:2,tokenLimit:1,theme:"facebook",allowCustomEntry:!0,preventDuplicates:!0,prePopulate:$("form#collaborators .translator_ids").data("load"),hintText:gon.tokeninput_collaborator_hintText,noResultsText:gon.tokeninput_collaborator_noResultsText,searchingText:gon.tokeninput_searchingText,resultsFormatter:function(e){return"<li><img src='"+e.img_url+"' title='"+e.name+"' height='28px' width='28px' /><div style='display: inline-block; padding-left: 10px;'><div>"+e.name+"</div></div></li>"},tokenFormatter:function(e){return void 0==e.img_url?"<li><p>"+e.name+"</p></li>":"<li><p><img src='"+e.img_url+"' title='"+e.name+"' height='50px' width='50px' /></p></li>"}})}function t(){$("form#collaborators #translator-form-rows").append($("#translator-form-row-template").html());var t=$("form#collaborators #translator-form-rows .translator-form-row").length;$("form#collaborators #translator-form-rows .translator-form-row:last").html($("form#collaborators #translator-form-rows .translator-form-row:last").html().replace(/INDEX/g,t)),$("form#collaborators #translator-form-rows .translator-form-row:last select").selectpicker(),$("form#collaborators #translator-form-rows .translator-form-row:last select").selectpicker("val",$("#translator-form-row-template").data("default")),e("form#collaborators #translator-form-rows .translator-form-row:last input.translator_ids")}$("form#collaborators #editor_ids").tokenInput(gon.collaborator_search,{method:"POST",minChars:2,theme:"facebook",allowCustomEntry:!0,preventDuplicates:!0,prePopulate:$("form#collaborators #editor_ids").data("load"),hintText:gon.tokeninput_collaborator_hintText,noResultsText:gon.tokeninput_collaborator_noResultsText,searchingText:gon.tokeninput_searchingText,resultsFormatter:function(e){return"<li><img src='"+e.img_url+"' title='"+e.name+"' height='28px' width='28px' /><div style='display: inline-block; padding-left: 10px;'><div>"+e.name+"</div></div></li>"},tokenFormatter:function(e){return void 0==e.img_url?"<li><p>"+e.name+"</p></li>":"<li><p><img src='"+e.img_url+"' title='"+e.name+"' height='50px' width='50px' /></p></li>"}}),e("form#collaborators .translator_ids"),$("form#collaborators a#add-translator").click(function(e){e.preventDefault(),t()}),t(),$(".current-collaborators a.remove-collaborator").click(function(e){console.log("remove collab!"),e.preventDefault();var t=this;$.ajax({url:$(t).data("url"),data:{user_id:$(t).data("id")},type:"POST",dataType:"json"}).done(function(e){var i="alert-danger",n="alert-info",o=i;e.success&&($(t).closest("li").fadeOut(),o=n),$("li#"+$(t).data("msg-id")).css("display","block").removeClass(i).removeClass(n).addClass(o).html(e.msg)})}),$("form#collaborators").on("click","a.remove-translator",function(e){e.preventDefault(),$(this).closest(".translator-form-row").remove(),0==$("form#collaborators #translator-form-rows .translator-form-row").length&&t()})});